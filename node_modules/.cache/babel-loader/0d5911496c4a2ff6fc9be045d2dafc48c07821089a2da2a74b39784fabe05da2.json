{"ast":null,"code":"import { wait } from './wait.js';\n/**\n * @description Polls a function at a specified interval.\n */\nexport function poll(fn, _ref) {\n  let {\n    emitOnBegin,\n    initialWaitTime,\n    interval\n  } = _ref;\n  let active = true;\n  const unwatch = () => active = false;\n  const watch = async () => {\n    var _await$initialWaitTim;\n    let data = undefined;\n    if (emitOnBegin) data = await fn({\n      unpoll: unwatch\n    });\n    const initialWait = (_await$initialWaitTim = await (initialWaitTime === null || initialWaitTime === void 0 ? void 0 : initialWaitTime(data))) !== null && _await$initialWaitTim !== void 0 ? _await$initialWaitTim : interval;\n    await wait(initialWait);\n    const poll = async () => {\n      if (!active) return;\n      await fn({\n        unpoll: unwatch\n      });\n      await wait(interval);\n      poll();\n    };\n    poll();\n  };\n  watch();\n  return unwatch;\n}","map":{"version":3,"names":["wait","poll","fn","_ref","emitOnBegin","initialWaitTime","interval","active","unwatch","watch","_await$initialWaitTim","data","undefined","unpoll","initialWait"],"sources":["/Users/kanaiyuuta/Downloads/test-yuuta-main/node_modules/viem/utils/poll.ts"],"sourcesContent":["import { wait } from './wait.js'\n\ntype PollOptions<TData> = {\n  // Whether or not to emit when the polling starts.\n  emitOnBegin?: boolean\n  // The initial wait time (in ms) before polling.\n  initialWaitTime?: (data: TData | void) => Promise<number>\n  // The interval (in ms).\n  interval: number\n}\n\n/**\n * @description Polls a function at a specified interval.\n */\nexport function poll<TData>(\n  fn: ({ unpoll }: { unpoll: () => void }) => Promise<TData | void>,\n  { emitOnBegin, initialWaitTime, interval }: PollOptions<TData>,\n) {\n  let active = true\n\n  const unwatch = () => (active = false)\n\n  const watch = async () => {\n    let data: TData | void = undefined\n    if (emitOnBegin) data = await fn({ unpoll: unwatch })\n\n    const initialWait = (await initialWaitTime?.(data)) ?? interval\n    await wait(initialWait)\n\n    const poll = async () => {\n      if (!active) return\n      await fn({ unpoll: unwatch })\n      await wait(interval)\n      poll()\n    }\n\n    poll()\n  }\n  watch()\n\n  return unwatch\n}\n"],"mappings":"AAAA,SAASA,IAAI,QAAQ,WAAW;AAWhC;;;AAGA,OAAM,SAAUC,IAAIA,CAClBC,EAAiE,EAAAC,IAAA,EACH;EAAA,IAA9D;IAAEC,WAAW;IAAEC,eAAe;IAAEC;EAAQ,CAAsB,GAAAH,IAAA;EAE9D,IAAII,MAAM,GAAG,IAAI;EAEjB,MAAMC,OAAO,GAAGA,CAAA,KAAOD,MAAM,GAAG,KAAM;EAEtC,MAAME,KAAK,GAAG,MAAAA,CAAA,KAAW;IAAA,IAAAC,qBAAA;IACvB,IAAIC,IAAI,GAAiBC,SAAS;IAClC,IAAIR,WAAW,EAAEO,IAAI,GAAG,MAAMT,EAAE,CAAC;MAAEW,MAAM,EAAEL;IAAO,CAAE,CAAC;IAErD,MAAMM,WAAW,IAAAJ,qBAAA,GAAI,OAAML,eAAe,aAAfA,eAAe,uBAAfA,eAAe,CAAGM,IAAI,CAAC,eAAAD,qBAAA,cAAAA,qBAAA,GAAKJ,QAAQ;IAC/D,MAAMN,IAAI,CAACc,WAAW,CAAC;IAEvB,MAAMb,IAAI,GAAG,MAAAA,CAAA,KAAW;MACtB,IAAI,CAACM,MAAM,EAAE;MACb,MAAML,EAAE,CAAC;QAAEW,MAAM,EAAEL;MAAO,CAAE,CAAC;MAC7B,MAAMR,IAAI,CAACM,QAAQ,CAAC;MACpBL,IAAI,EAAE;IACR,CAAC;IAEDA,IAAI,EAAE;EACR,CAAC;EACDQ,KAAK,EAAE;EAEP,OAAOD,OAAO;AAChB"},"metadata":{},"sourceType":"module","externalDependencies":[]}